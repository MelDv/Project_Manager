{% extends "base.html" %}
{% block content %}

{% import "macros/forms.html" as forms %}

{% if user_logged_in.current_rights=="admin" %}
<a class="btn btn-default" href="{{base_path}}/uusi">Uusi projekti</a>
{% endif %}

<br><br><br>
<h2 id="project">Projektit</h2>
<br><br>

{% if pages > 1 %}
<nav>
    <ul class="pagination">
        <li class="{% if not prev_page %}disabled{% endif %}"><a href="{{base_path}}/projektit?page={{prev_page}}">
                <span  class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span></a></li>
        {% for page in 1..pages %}
        <li class="{% if curr_page == page %}active{% endif %}"><a href="{{base_path}}/projektit?page={{page}}">{{page}}</a></li>
        {% endfor %}
        <li class="{% if not next_page %}disabled{% endif %}"><a href="{{base_path}}/projektit?page={{next_page}}">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span></a></li>
    </ul>
</nav>
{% endif %}

<table class="table table-hover">
    <thead>
        <tr>
            <th></th>
            <th>Nimi</th>
            <th>Valmiina %</th>
            <th>Kuvaus</th>
            <th>Tehtävät</th>
            <th>Tekijät</th>
            <th></th>
        </tr>
    </thead>

    <tbody>
        {% set name="test" %}
        {{project.name}}
        {% for project in projects if project.name!=name %}
        {% set name=project.name %}
        {{project.name}}      
        <!-- Projektit -->
        <tr>
            <td id="index">{{loop.index + (page-1) * page_size}}</td>
            <td><a href="{{base_path}}/projektit/{{project.id}}">{{project.name}}</a></td>
            <td>33 %</td>
            <td>{{project.description}}</td>
            <th>
                <!--Tehtävät-->
                {% if project.task_name!=null %}
                <div class="dropdown">
                    <button type="button" class="btn btn-primary dropdown-toggle" id="projektilista" data-toggle="dropdown">Tehtävät
                        <span class="caret"></span></button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="tehtavalista">
                        {% for project in projects if project.name == name %}
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="{{base_path}}/projektit/{{project.id}}/tehtavat/{{project.task_id}}">{{project.task_name}}</a></li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </th>
            <th>
                <!--Tekijät-->
                <div class="dropdown">
                    <button type="button" class="btn btn-primary dropdown-toggle" id="tekijalista" data-toggle="dropdown">Tekijät
                        <span class="caret"></span></button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="tekijalista">
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Jaana</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Saana</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Reiska</a></li>
                    </ul>
                </div>
            </th>
            <th><th><a class="btn btn-success">Lisää tehtävä</a></th>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}